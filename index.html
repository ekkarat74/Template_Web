<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INSIGHT. | Future Intelligence</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;500;700&family=Bricolage+Grotesque:wght@800&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        :root { 
            --accent: #818cf8; 
            --bg-dark: #050505;
            --card-bg: rgba(255, 255, 255, 0.03);
        }
        body { 
            font-family: 'Space Grotesk', sans-serif; 
            background-color: var(--bg-dark); 
            color: #e2e8f0; 
            overflow-x: hidden; 
        }
        .heading-font { font-family: 'Bricolage Grotesque', sans-serif; }
        
        /* Transitions */
        .page-section { display: none; opacity: 0; }
        .page-section.active { display: block; opacity: 1; animation: fadeIn 0.8s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* UI Elements */
        .glass-nav { background: rgba(5, 5, 5, 0.8); backdrop-filter: blur(20px); border-bottom: 1px solid rgba(255, 255, 255, 0.1); }
        .bento-card { background: var(--card-bg); border: 1px solid rgba(255, 255, 255, 0.08); border-radius: 24px; transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        .bento-card:hover { background: rgba(255, 255, 255, 0.06); border-color: var(--accent); transform: scale(1.01); }
        .text-gradient { background: linear-gradient(to right, #fff, #818cf8); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        
        /* Orbs */
        .orb { position: absolute; width: 400px; height: 400px; border-radius: 50%; background: radial-gradient(circle, rgba(129, 140, 248, 0.15) 0%, transparent 70%); filter: blur(60px); z-index: -1; }

        /* Reader Modal */
        #reading-modal { display: none; position: fixed; inset: 0; z-index: 300; background: rgba(5, 5, 5, 0.98); overflow-y: auto; }
        .reading-content { max-width: 800px; margin: 6rem auto; animation: slideUp 0.5s cubic-bezier(0.22, 1, 0.36, 1); }
        @keyframes slideUp { from { opacity: 0; transform: translateY(50px); } to { opacity: 1; transform: translateY(0); } }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: var(--bg-dark); }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--accent); }
    </style>
</head>
<body>

    <nav class="glass-nav sticky top-0 z-[100] px-6 py-4">
        <div class="container mx-auto flex justify-between items-center">
            <button onclick="navigateTo('home')" class="heading-font text-2xl font-extrabold tracking-tighter">
                INSIGHT<span class="text-indigo-400">.</span>
            </button>
            <div class="hidden md:flex space-x-8 text-xs font-medium uppercase tracking-widest">
                <button onclick="navigateTo('home')" class="hover:text-indigo-400 transition">Intelligence</button>
                <button onclick="navigateTo('articles')" class="hover:text-indigo-400 transition">Archive</button>
                <button onclick="navigateTo('write')" class="bg-indigo-500/10 text-indigo-400 px-4 py-1.5 rounded-full border border-indigo-500/20 hover:bg-indigo-500 hover:text-white transition">Draft</button>
            </div>
            <div id="nav-auth-section">
                <button onclick="showAuthModal()" id="btn-login-ui" class="text-xs font-bold px-5 py-2 rounded-full border border-white/10 hover:bg-white hover:text-black transition uppercase">Join us</button>
                <div id="user-info-ui" class="hidden flex items-center gap-4">
                    <span id="display-email" class="text-[10px] text-indigo-400 font-bold border-r border-white/10 pr-4 uppercase tracking-widest"></span>
                    <button onclick="handleLogout()" class="text-white/40 hover:text-red-400 transition">Logout</button>
                </div>
            </div>
        </div>
    </nav>

    <div id="reading-modal" class="px-6">
        <div class="container mx-auto">
            <button onclick="closeReader()" class="fixed top-8 right-8 z-[310] bg-white/5 hover:bg-white/10 text-white w-12 h-12 rounded-full flex items-center justify-center backdrop-blur-md transition">✕</button>
            <div class="reading-content">
                <div id="reader-meta" class="text-indigo-400 font-bold text-xs uppercase tracking-[0.4em] mb-8"></div>
                <h1 id="reader-title" class="heading-font text-4xl md:text-7xl font-black mb-12 leading-[1.1] tracking-tighter"></h1>
                <div id="reader-image" class="w-full h-[300px] md:h-[500px] rounded-[2rem] overflow-hidden mb-12"></div>
                <div id="reader-body" class="text-slate-300 text-lg md:text-xl leading-relaxed space-y-8 font-light whitespace-pre-line pb-20"></div>
            </div>
        </div>
    </div>

    <section id="home-page" class="page-section active relative min-h-screen">
        <div class="orb top-0 right-0"></div>
        <div class="orb bottom-0 left-0"></div>
        
        <div class="container mx-auto px-6 pt-16">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-16">
                <div class="lg:col-span-2">
                    <h1 class="heading-font text-7xl md:text-[10rem] font-black leading-[0.8] tracking-tighter text-gradient mb-10">
                        EYES ON<br>THE FUTURE.
                    </h1>
                    <p class="text-xl text-slate-400 max-w-xl font-light leading-relaxed">
                        เจาะลึกบทวิเคราะห์ที่ขับเคลื่อนด้วย Data และมุมมองจากผู้เชี่ยวชาญทั่วโลก เพื่อก้าวนำในยุคดิจิทัล
                    </p>
                </div>
                <div class="flex flex-col justify-end gap-4">
                    <button onclick="navigateTo('articles')" class="w-full py-8 bento-card flex justify-between items-center px-8 hover:bg-indigo-600 group">
                        <span class="font-bold uppercase tracking-widest text-sm">Open the archive</span>
                        <span class="text-2xl group-hover:translate-x-2 transition">→</span>
                    </button>
                    <div class="p-8 bento-card bg-indigo-500/5">
                        <p class="text-[10px] uppercase tracking-[0.3em] text-indigo-400 mb-2 font-black">Latest Update</p>
                        <p class="text-sm font-medium">New intelligence report on Semiconductor Crisis just released.</p>
                    </div>
                </div>
            </div>

            <div class="bento-card p-1 lg:p-2 mb-20 overflow-hidden cursor-pointer" 
                 onclick="openReader('Editorial Pick', 'The End of Search: How Generative AI Replaces the Google Era', 'https://images.unsplash.com/photo-1639322537228-f710d846310a?q=80&w=1600', 'เมื่อ AI เข้ามาทำหน้าที่สรุปคำตอบโดยตรง ไม่ใช่แค่การแสดงลิงก์... ยุคสมัยของการค้นหาข้อมูลกำลังเปลี่ยนไปอย่างถาวรสู่ยุคของ Intelligent Assistants ที่มีความแม่นยำสูงขึ้น')">
                <div class="relative rounded-[20px] overflow-hidden group h-[600px]">
                    <img src="https://images.unsplash.com/photo-1639322537228-f710d846310a?q=80&w=1600" class="w-full h-full object-cover opacity-60 group-hover:scale-105 transition duration-[2s]">
                    <div class="absolute inset-0 bg-gradient-to-t from-black via-black/40 to-transparent p-8 md:p-16 flex flex-col justify-end">
                        <span class="bg-indigo-500 text-white text-[10px] font-black px-4 py-1 rounded-full w-fit mb-6 tracking-widest uppercase">Must Read</span>
                        <h2 class="heading-font text-4xl md:text-7xl font-bold max-w-4xl mb-8 leading-[0.9] tracking-tighter">The End of Search: How Generative AI Replaces the Google Era</h2>
                        <div class="flex items-center gap-8 border-t border-white/10 pt-8">
                            <div>
                                <p class="text-[10px] text-white/40 uppercase tracking-widest mb-1 font-bold">Written By</p>
                                <p class="text-sm font-bold">INSIGHT EDITORIAL</p>
                            </div>
                            <button class="ml-auto w-14 h-14 bg-white text-black rounded-full flex items-center justify-center font-bold">READ</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mb-32">
                <div class="flex items-center gap-6 mb-12">
                    <h3 class="heading-font text-2xl font-bold uppercase tracking-widest">New Intelligence</h3>
                    <div class="h-[1px] flex-grow bg-white/10"></div>
                </div>
                <div id="posts-container-home" class="grid grid-cols-1 md:grid-cols-3 gap-8"></div>
            </div>
        </div>
    </section>

    <section id="articles-page" class="page-section py-20">
        <div class="container mx-auto px-6">
            <h2 class="heading-font text-6xl md:text-8xl font-black mb-16 tracking-tighter">Archive<span class="text-indigo-500">_</span></h2>
            <div id="posts-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"></div>
        </div>
    </section>

    <section id="write-page" class="page-section py-20">
        <div class="container mx-auto px-6 max-w-3xl">
            <div class="bento-card p-12 bg-white/5">
                <h2 class="heading-font text-4xl mb-12 tracking-tight">Draft New Story</h2>
                <div class="space-y-8">
                    <div class="space-y-2">
                        <label class="text-[10px] font-bold uppercase text-white/40 tracking-widest">Article Title</label>
                        <input type="text" id="post-title" class="w-full bg-white/5 border-b border-white/20 p-4 outline-none focus:border-indigo-500 transition-all text-xl" placeholder="...">
                    </div>
                    <div class="space-y-2">
                        <label class="text-[10px] font-bold uppercase text-white/40 tracking-widest">Content Body</label>
                        <textarea id="post-content" rows="10" class="w-full bg-white/5 border-b border-white/20 p-4 outline-none focus:border-indigo-500 transition-all text-lg font-light" placeholder="Start your insight..."></textarea>
                    </div>
                    <div class="space-y-2">
                        <label class="text-[10px] font-bold uppercase text-white/40 tracking-widest">Cover Image URL</label>
                        <input type="text" id="post-image" class="w-full bg-white/5 border-b border-white/20 p-4 outline-none focus:border-indigo-500 transition-all" placeholder="https://...">
                    </div>
                    <button onclick="handlePublish()" class="w-full py-5 bg-indigo-500 text-white font-black rounded-2xl hover:bg-indigo-600 transition tracking-widest uppercase">Publish to Hub</button>
                </div>
            </div>
        </div>
    </section>

    <div id="auth-modal" class="fixed inset-0 bg-black/90 backdrop-blur-2xl z-[200] hidden flex items-center justify-center p-6">
        <div class="bento-card bg-zinc-950 w-full max-w-md p-10 border-white/10 shadow-2xl">
            <div class="flex justify-between items-center mb-10">
                <h2 id="auth-title" class="heading-font text-2xl font-bold tracking-tighter uppercase">Member Gateway</h2>
                <button onclick="hideAuthModal()" class="text-white/40 hover:text-white">✕</button>
            </div>
            <div class="space-y-4">
                <input type="email" id="auth-email" placeholder="Email Address" class="w-full bg-black/50 border border-white/10 rounded-xl p-4 outline-none focus:border-indigo-500 transition">
                <input type="password" id="auth-password" placeholder="Password" class="w-full bg-black/50 border border-white/10 rounded-xl p-4 outline-none focus:border-indigo-500 transition">
                <button id="auth-main-btn" class="w-full py-4 bg-white text-black font-black rounded-xl hover:bg-indigo-400 transition uppercase tracking-widest mt-4">Continue</button>
            </div>
            <p class="text-center mt-8 text-xs text-white/40 uppercase tracking-widest font-bold">
                <button onclick="toggleAuthMode()" id="auth-toggle-btn" class="hover:text-indigo-400 border-b border-white/10">Apply for Access</button>
            </p>
        </div>
    </div>

    <script>
        // --- Supabase Config ---
        const SUPABASE_URL = 'https://glmxblgtvtgjoegyscva.supabase.co';
        const SUPABASE_KEY = 'sb_publishable_pZXXnhEAlkQQlkkm-QNOSQ_Uu0XEzLg';
        const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        let isLoginMode = true;

        // --- Core Functions ---
        async function updateUI(user) {
            const loginBtn = document.getElementById('btn-login-ui');
            const userInfo = document.getElementById('user-info-ui');
            if (user) {
                loginBtn.classList.add('hidden');
                userInfo.classList.remove('hidden');
                document.getElementById('display-email').innerText = user.email.split('@')[0];
                hideAuthModal();
            } else {
                loginBtn.classList.remove('hidden');
                userInfo.classList.add('hidden');
            }
        }

        // --- Reader Management ---
        window.openReader = (meta, title, img, content) => {
            document.getElementById('reader-meta').innerText = meta;
            document.getElementById('reader-title').innerText = title;
            document.getElementById('reader-image').innerHTML = `<img src="${img}" class="w-full h-full object-cover">`;
            document.getElementById('reader-body').innerText = content;
            
            document.getElementById('reading-modal').style.display = 'block';
            document.body.style.overflow = 'hidden';
        };

        window.closeReader = () => {
            document.getElementById('reading-modal').style.display = 'none';
            document.body.style.overflow = 'auto';
        };

        // --- Auth & Posts Logic ---
        document.getElementById('auth-main-btn').addEventListener('click', async () => {
            const email = document.getElementById('auth-email').value;
            const password = document.getElementById('auth-password').value;
            try {
                if (isLoginMode) {
                    const { error } = await supabaseClient.auth.signInWithPassword({ email, password });
                    if (error) throw error;
                } else {
                    const { error } = await supabaseClient.auth.signUp({ email, password });
                    if (error) throw error;
                    alert('Check your email to verify account!');
                }
            } catch (err) { alert(err.message); }
        });

        supabaseClient.auth.onAuthStateChange((e, session) => updateUI(session?.user || null));
        window.handleLogout = async () => await supabaseClient.auth.signOut();

        async function fetchPosts() {
            const { data, error } = await supabaseClient.from('posts').select('*').order('created_at', { ascending: false });
            if (error) return;
            
            const renderPost = (post) => `
                <div class="bento-card overflow-hidden group cursor-pointer" 
                     onclick="openReader('INTELLIGENCE ARCHIVE', '${post.title.replace(/'/g, "\\'")}', '${post.image_url}', '${post.content.replace(/'/g, "\\'").replace(/\n/g, "\\n")}')">
                    <div class="h-64 overflow-hidden">
                        <img src="${post.image_url || 'https://images.unsplash.com/photo-1550751827-4bd374c3f58b'}" class="w-full h-full object-cover group-hover:scale-110 transition duration-700 opacity-70">
                    </div>
                    <div class="p-8">
                        <div class="flex justify-between items-center mb-6 text-[10px] font-black text-indigo-400 uppercase tracking-[0.2em]">
                            <span>${post.author_email.split('@')[0]}</span>
                            <span class="text-white/20">2026</span>
                        </div>
                        <h3 class="text-2xl font-bold mb-4 leading-tight group-hover:text-indigo-400 transition">${post.title}</h3>
                        <p class="text-white/40 text-sm font-light line-clamp-2 mb-8 leading-relaxed">${post.content}</p>
                        <div class="flex items-center gap-2 text-[10px] font-black uppercase tracking-widest group-hover:gap-4 transition-all">
                            Read Essay <span>→</span>
                        </div>
                    </div>
                </div>
            `;

            document.getElementById('posts-container').innerHTML = data.map(renderPost).join('');
            document.getElementById('posts-container-home').innerHTML = data.slice(0, 3).map(renderPost).join('');
        }

        async function handlePublish() {
            const title = document.getElementById('post-title').value;
            const content = document.getElementById('post-content').value;
            const imageUrl = document.getElementById('post-image').value;
            const { data: { session } } = await supabaseClient.auth.getSession();

            if (!session) return alert('Login required to publish.');
            const { error } = await supabaseClient.from('posts').insert([{ title, content, image_url: imageUrl, author_email: session.user.email }]);

            if (error) alert(error.message);
            else {
                alert('Insight Published!');
                navigateTo('articles');
                fetchPosts();
                document.getElementById('post-title').value = '';
                document.getElementById('post-content').value = '';
            }
        }

        // --- Navigation & UI Helpers ---
        window.navigateTo = (pageId) => {
            document.querySelectorAll('.page-section').forEach(s => s.classList.remove('active'));
            document.getElementById(pageId + '-page').classList.add('active');
            window.scrollTo({ top: 0, behavior: 'smooth' });
            if(pageId === 'home' || pageId === 'articles') fetchPosts();
        };

        window.showAuthModal = () => document.getElementById('auth-modal').classList.remove('hidden');
        window.hideAuthModal = () => document.getElementById('auth-modal').classList.add('hidden');
        window.toggleAuthMode = () => {
            isLoginMode = !isLoginMode;
            document.getElementById('auth-title').innerText = isLoginMode ? 'Member Gateway' : 'New Identity';
            document.getElementById('auth-toggle-btn').innerText = isLoginMode ? 'Apply for Access' : 'Return to Login';
        };

        // --- Init ---
        (async () => {
            const { data: { session } } = await supabaseClient.auth.getSession();
            updateUI(session?.user || null);
            fetchPosts();
        })();
    </script>
</body>
</html>